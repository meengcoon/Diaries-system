<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Diary System</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
  <div class="app-shell">
    <header class="topbar">
      <div>
        <h1>Diary System</h1>
        <p class="tagline">一个窗口里写日记、聊天与查看画像</p>
      </div>
      <div class="system-pill" id="system-pill">系统检查中...</div>
    </header>

    <nav class="top-menu" aria-label="主菜单">
      <button class="menu-item active" data-view="chat" type="button">对话</button>
      <button class="menu-item" data-view="notebook" type="button">日记本</button>
      <button class="menu-item" data-view="insights" type="button">数据画像</button>
    </nav>

    <main class="workspace-single">
      <section class="panel view-panel" id="view-chat">
        <div class="panel-head">
          <h2>对话窗口</h2>
          <div class="chat-tools">
            <label class="debug-toggle">
              <input type="checkbox" id="debug-toggle" />
              <span>Debug</span>
            </label>
            <button id="clear-chat-btn" class="ghost-btn" type="button">清空会话</button>
          </div>
        </div>

        <div id="chat-messages" class="chat-messages">
          <div class="chat-empty">直接输入内容。系统会自动判断你是在写日记还是在聊天。</div>
        </div>

        <details class="debug-panel" id="debug-panel">
          <summary>最近一次 Debug 数据</summary>
          <pre id="debug-output">暂无</pre>
        </details>

        <div class="composer-wrap">
          <textarea
            id="unified-input"
            rows="3"
            placeholder="输入你想说的话。回车发送，Shift+回车换行。"
          ></textarea>
          <div class="composer-actions">
            <button id="send-btn" class="primary-btn" type="button">发送</button>
            <span id="status" class="status-text"></span>
          </div>
        </div>
      </section>

      <section class="panel view-panel hidden" id="view-notebook">
        <div class="panel-head">
          <h2>日记本</h2>
          <button id="refresh-history-btn" class="ghost-btn" type="button">刷新</button>
        </div>

        <div class="notebook-layout">
          <aside class="history-pane">
            <div class="history-head">
              <span>历史记录</span>
            </div>
            <div class="history-list" id="history-list">
              <div class="history-empty">暂无历史记录</div>
            </div>
          </aside>

          <section class="reader-pane">
            <h3 id="reader-date">请选择一条日记</h3>
            <pre id="reader-content" class="reader-content">读取后会在这里展示内容。</pre>
          </section>
        </div>
      </section>

      <section class="panel view-panel hidden" id="view-insights">
        <div class="panel-head">
          <h2>数据画像</h2>
          <button id="refresh-insights-btn" class="ghost-btn" type="button">刷新画像</button>
        </div>

        <div class="metric-grid summary-grid">
          <div class="metric-item"><span class="metric-name">日记文件数</span><span class="metric-value" id="s-diaries">-</span></div>
          <div class="metric-item"><span class="metric-name">结构化条目数</span><span class="metric-value" id="s-entries">-</span></div>
          <div class="metric-item"><span class="metric-name">分析样本数</span><span class="metric-value" id="s-analysis">-</span></div>
          <div class="metric-item"><span class="metric-name">队列中任务</span><span class="metric-value" id="s-pending">-</span></div>
        </div>

        <div class="result-box">
          <div class="result-title">平均信号（0-10）</div>
          <div class="signals" id="signals-line">-</div>
        </div>

        <div class="insight-columns">
          <div class="result-box">
            <div class="result-title">人格特点</div>
            <ul id="trait-list" class="insight-list"><li>暂无</li></ul>
          </div>

          <div class="result-box">
            <div class="result-title">优点</div>
            <ul id="strength-list" class="insight-list"><li>暂无</li></ul>
          </div>

          <div class="result-box">
            <div class="result-title">可改进点</div>
            <ul id="weakness-list" class="insight-list"><li>暂无</li></ul>
          </div>
        </div>

        <div class="result-box">
          <div class="result-title">近期高频主题</div>
          <div id="topic-list" class="topic-list">暂无</div>
        </div>
      </section>
    </main>
  </div>

  <script src="app.js"></script>
</body>
</html>
